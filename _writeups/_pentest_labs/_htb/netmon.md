[**< back**](/README.md)

# HTB - NetMon
**Machine**: NetMon  
**Author**: Nika Kharebava  

## Information Gathering  
### NMap  
Initial enumeration using rustscan :mag:  
`rustscan -a 10.129.149.120 --range 1-65000 --ulimit 5000`  

![initial_rustscan](/_storage/_img/_pentest_labs/_htb/netmon/initial_rustscan.png)  

Navigating the port 80 leads us to prtg page  
![prtg_mon](/_storage/_img/_pentest_labs/_htb/netmon/prtg_network_monitoring.png)  

Checking if ftp allows anonymous logins and if there's anything interesting stored in there...  
![ftp_anon](/_storage/_img/_pentest_labs/_htb/netmon/ftp_anonymous_login_check.png)  
While messing around with ftp manually I ran another nmap scan in the background `nmap -sV -sC -T5 -Pn 10.129.149.120 -p21,80,135,139`  
![background_nmap_scan](/_storage/_img/_pentest_labs/_htb/netmon/background_nmap_scan.png)  

Thing's I've discovered rn is that This version of PRTG is most likely vulnerable to Authenticated Command Injection, but first we need credentials to try it out (I have tried default `prtgadmin:prtgadmin` thing but it didn't work)   


## Exploitation

Nice reference for exploiting tomcat `https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/tomcat`


After a bit of research I found out that we can not access the tomcat manager from web gui but it is accessible as from the curl...  

We can gain shell just by generating a venom shell and uploading it to manager page...  
![msfvenom_generate_shell](/_storage/_img/_pentest_labs/_htb/tabby/msfvenom_generate_shell.png)  
Lets upload it using creds we've acquired...  
![shell_uploaded](/_storage/_img/_pentest_labs/_htb/tabby/shell_uploaded.png)  
