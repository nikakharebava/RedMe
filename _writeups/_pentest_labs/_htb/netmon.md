[**< back**](/README.md)

# HTB - NetMon
**Machine**: NetMon  
**Author**: Nika Kharebava  

## Information Gathering  
### Rustscan/Nmap  
Initial enumeration using rustscan :mag:  
`rustscan -a 10.129.149.120 --range 1-65000 --ulimit 5000`  

![initial_rustscan](/_storage/_img/_pentest_labs/_htb/netmon/initial_rustscan.png)  

Navigating the port 80 leads us to prtg page  
![prtg_mon](/_storage/_img/_pentest_labs/_htb/netmon/prtg_network_monitoring.png)  

Checking if ftp allows anonymous logins and if there's anything interesting stored in there...  
![ftp_anon](/_storage/_img/_pentest_labs/_htb/netmon/ftp_anonymous_login_check.png)  
While messing around with ftp manually I ran another nmap scan in the background `nmap -sV -sC -T5 -Pn 10.129.149.120 -p21,80,135,139`  
![background_nmap_scan](/_storage/_img/_pentest_labs/_htb/netmon/background_nmap_scan.png)  

Thing's I've discovered rn is that This version of PRTG is most likely vulnerable to Authenticated Command Injection, but first we need credentials to try it out (I have tried default `prtgadmin:prtgadmin` thing but it didn't work)   
![background_bruteforce](/_storage/_img/_pentest_labs/_htb/netmon/background_bruteforce.png)  
I've launched background bruteforce just in case, while I'm inspecting the server from ftp  
![prtg_conf_files](/_storage/_img/_pentest_labs/_htb/netmon/prtg_conf_files.png)  
This should help (hydra didn't do us any favor)  
and it did, there's `PRTG Configuration.old.bak` which contains password for `prtgadmin` user  
![creds_discovered](/_storage/_img/_pentest_labs/_htb/netmon/creds_discovered.png)  
`prtgadmin:PrTg@dmin2018`  


## Exploitation

Since, we've acquired credentials now it's time to exploit vulnerability for this particular version of PRTG Monitor  
I couldn't login with creds `prtgadmin:PrTg@dmin2018` but after changing it to `prtgadmin:PrTg@dmin2019` login was successful  
![prt_login_success](/_storage/_img/_pentest_labs/_htb/netmon/prtg_login_sucess.png)  

I've found the python script exploiting the vulnerability we've already discovered in PRTG, `https://github.com/A1vinSmith/CVE-2018-9276`  
![launching_exploit](/_storage/_img/_pentest_labs/_htb/netmon/launching_exploit.png)  
and shell gained  
![nt_authority_shell](/_storage/_img/_pentest_labs/_htb/netmon/nt_authority_shell.png)  
That's it...  
![my_time_has_come](/_storage/_img/_pentest_labs/_htb/netmon/my-time-has-come.gif)  