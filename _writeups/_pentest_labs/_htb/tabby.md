[**< back**](/README.md)

# HTB - Tabby

![help_banner](/_storage/_img/_pentest_labs/_htb/tabby/tabby.png)  
**Machine**: Tabby  
**Author**: Nika Kharebava  

## Information Gathering  
### NMap  
Initial enumeration using Nmap :mag:  
`nmap -sV -sC -T5 -Pn 10.129.226.92 -oA tabby`  

![initial_nmap_scan](/_storage/_img/_pentest_labs/_htb/tabby/initial_nmap_scan.png)  

So it is running two web services, on port 80 and on port 8080  

**MegaHosting** on Port 80
![mega_hosting](/_storage/_img/_pentest_labs/_htb/tabby/mega_hosting.png)

After surfing the web a bit I discovered an endpoint... `news.php?file=statement`, at a glance I thought it might be sql injectable, then I realized the parameter said `file`, so why not to try path traversal, which worked fine.

![path_traversal_discovered](/_storage/_img/_pentest_labs/_htb/tabby/path_traversal_discovered.png)

Which means we can fetch other configuration files of tocmat to upload a shell there and gain access to it... maybe... 

![tomcat_xml_warning](/_storage/_img/_pentest_labs/_htb/tabby/tomcat_xml_warning.png)  

The only thing left is to find the actual xml configuration file...

After googling a bit and little trial and error this is what I've got `http://megahosting.htb/news.php?file=../../../../../../../../usr/share/tomcat9/etc/tomcat-users.xml`  
![tomcat_creds_found](/_storage/_img/_pentest_labs/_htb/tabby/tomcat_creds_found.png)  

I was unable to login in `manager` page but I could login into the `host-manager`  
![host_manager_page](/_storage/_img/_pentest_labs/_htb/tabby/host_manager_page.png)

I tried setting up a smbserver to server payload to tomcat but it was not very successful...  
![smb_server_test](/_storage/_img/_pentest_labs/_htb/tabby/smb_server_test.png)  
![tomcat_failed](/_storage/_img/_pentest_labs/_htb/tabby/tomcat_failed.png)  
So... probably there should be another way of exploiting it after all.  


## Exploitation

Nice reference for exploiting tomcat `https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/tomcat`


After a bit of research I found out that we can not access the tomcat manager from web gui but it is accessible as from the curl...  

We can gain shell just by generating a venom shell and uploading it to manager page...  
![msfvenom_generate_shell](/_storage/_img/_pentest_labs/_htb/tabby/msfvenom_generate_shell.png)  
Lets upload it using creds we've acquired...  
![shell_uploaded](/_storage/_img/_pentest_labs/_htb/tabby/shell_uploaded.png)  
